function getOrCreateUserId(){let e=localStorage.getItem("userId");return e||(e=crypto.randomUUID(),localStorage.setItem("userId",e)),e}function setUserId(e){e&&localStorage.setItem("userId",e)}document.addEventListener("DOMContentLoaded",()=>{htmx.trigger("#todo-list","triggerLoad");const e=document.querySelector("#userIdContainer"),t=document.querySelector("#userIdEditForm"),r=document.querySelector("#userIdDisplay"),s=document.querySelector("#userIdEditField"),c=document.querySelector("#userIdEditButton"),a=document.querySelector("#userIdCancelButton"),d=getOrCreateUserId();function u(){t.classList.add("shown"),t.classList.remove("hidden"),e.classList.remove("shown"),e.classList.add("hidden")}function n(){e.classList.add("shown"),e.classList.remove("hidden"),t.classList.remove("shown"),t.classList.add("hidden")}e&&r&&s&&t&&c&&a&&(r.innerHTML=d,s.value=d,t.addEventListener("submit",o=>{o.preventDefault();const i=s.value;i&&i!==d&&(localStorage.setItem("userId",s.value),r.innerHTML=getOrCreateUserId(),htmx.ajax("GET",`/api/changeUserId?old=${d}&new=${i}`,"#todo-list")),n()}),c.addEventListener("click",()=>{u(),setTimeout(()=>{s.select()},0)}),s.addEventListener("keydown",o=>{o.key==="Escape"&&n()}),a.addEventListener("click",()=>{n()}))});
